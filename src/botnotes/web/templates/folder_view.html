{% extends "base.html" %}

{% block title %}{% if folder %}{{ folder }}{% else %}Top-level{% endif %} - Notes{% endblock %}

{% block content %}
<div class="breadcrumbs">
    <a href="/">All Notes</a>
    {% if not folder %}
    / <strong>Top-level</strong>
    {% else %}
    / <a href="/folder">Top-level</a>
    {% for crumb in breadcrumbs %}
    / {% if loop.last %}<strong>{{ crumb.name }}</strong>{% else %}<a href="/folder/{{ crumb.path }}">{{ crumb.name }}</a>{% endif %}
    {% endfor %}
    {% endif %}
</div>

{% if index_note %}
<div class="card">
    <h2>{{ index_note.title }}</h2>
    <div class="metadata">
        <a href="/notes/{{ index_note.path }}/edit">Edit</a> |
        <a href="/notes/{{ index_note.path }}/history">History</a>
        {% if index_note.tags %}
        | {% for tag in index_note.tags %}<a href="/tags/{{ tag }}" class="tag">{{ tag }}</a>{% endfor %}
        {% endif %}
    </div>
    <div class="note-content rendered-markdown">
        {{ index_note.content|render_markdown|safe }}
    </div>
</div>
{% endif %}

<div class="card">
    <h2>{% if not index_note %}{% if folder %}{{ folder }}{% else %}Top-level{% endif %}{% else %}Contents{% endif %}</h2>

    {% if subfolders %}
    <div class="subfolders">
        <h3>Folders</h3>
        {% for sf in subfolders %}
        <div class="folder-item">
            <a href="/folder/{{ sf }}">üìÅ {{ sf.split('/')[-1] }}</a>
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <div id="notes-list">
        {% if notes %}
            <h3>Notes</h3>
            {% for note in notes %}
            <div class="note-item">
                <div>
                    <a href="/notes/{{ note.path }}">{{ note.title }}</a>
                    <div class="note-path">{{ note.path }}</div>
                    {% if note.tags %}
                    <div>
                        {% for tag in note.tags %}
                        <span class="tag">{{ tag }}</span>
                        {% endfor %}
                    </div>
                    {% endif %}
                </div>
            </div>
            {% endfor %}
        {% elif not subfolders %}
            <div class="empty-state">
                <p>No contents in this folder.</p>
                <a href="/new" class="btn">Create a note</a>
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}
